created: 20241226052040232
modified: 20250117155207764
tags: Memo VARNA RNA Plot 2D
title: VARNA: plot 2D structure with color map
type: text/vnd.tiddlywiki

<br>

''Command line tools:'' `java` and `VARNAv3-93.jar` (downloadable at [[VARNA|https://varna.lisn.upsaclay.fr/index.php?lang=en&page=command&css=varna]])

<br>

!!!! Aim:

<a href="https://ucarecdn.com/b3903fa4-efaf-4e6c-94d9-d0c621efc38f/varna-cmap.png
" target="_blank" rel="noopener noreferrer" class="center"><img src="https://ucarecdn.com/b3903fa4-efaf-4e6c-94d9-d0c621efc38f/varna-cmap.png
" alt="WESTERLIES" width="650"></a>


!!!! Data:

RNA sequence and 2D structure:

```
AACCCUUAAACUAAAACAGCUCUGGGGUUGUACCCACCCCAGAGGCCCACGUGGCGGCUAGUACUCCGGUAUUGCGGUACCCUUGUACGCCUGUUUUAGUU
((...))...((((((((.(((((((((.......)))))))))(((.....)))(((..((((...((((......))))...)))))))))))))))..
```

Reactivity for each nucleotide:

```
0.7 0.8 0.2 1.0 1.0 1.0 0.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 1.0 1.0 1.0 1.0 0.5 0.5 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5 1.0 0.5 0.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.5 1.0 1.0 0.5 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5 1.0 1.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.5 0.5 0.5 0.0 0.5 0.5 1.0 0.5 0.5 0.5 0.0 0.5 0.0 0.5 0.0 0.5 0.5
```

<br>

!!!! Command:

//''viridis color map''//

```sh
java -cp ./VARNAv3-93.jar fr.orsay.lri.varna.applications.VARNAcmd -sequenceDBN "AACCCUUAAACUAAAACAGCUCUGGGGUUGUACCCACCCCAGAGGCCCACGUGGCGGCUAGUACUCCGGUAUUGCGGUACCCUUGUACGCCUGUUUUAGUU" -structureDBN "((...))...((((((((.(((((((((.......)))))))))(((.....)))(((..((((...((((......))))...))))))))))))))).." -bp "#606060" -backbone "#000000" -basesStyle1 "outline=#A0A0A0,label=#A0A0A0,fill=#FFFFFF" -basesStyle2 "outline=#0000FF,label=#0000FF,fill=#FFFFFF" -basesStyle3 "outline=#FF0000,label=#FF0000,fill=#FFFFFF" -drawBases False -baseInner "#FFFFFF" -spaceBetweenBases "0.57" -drawBackbone False -bpStyle simple -colorMapStyle "0:#405087;0.5:#59B082;1:#F9E756" -colorMap "0.7;0.8;0.2;1.0;1.0;1.0;0.0;1.0;1.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;1.0;1.0;1.0;1.0;1.0;0.5;0.5;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.5;1.0;0.5;0.0;0.0;0.0;1.0;0.0;0.0;1.0;0.0;0.5;1.0;1.0;0.5;1.0;1.0;1.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.5;1.0;1.0;1.0;0.0;0.0;0.0;0.0;0.0;0.0;0.5;0.5;0.5;0.0;0.5;0.5;1.0;0.5;0.5;0.5;0.0;0.5;0.0;0.5;0.0;0.5;0.5;" -o Plot.png -resolution "5.0"
```

<br>

//''grey-yellow-red color map''//

```sh
java -cp ./VARNAv3-93.jar fr.orsay.lri.varna.applications.VARNAcmd -sequenceDBN "AACCCUUAAACUAAAACAGCUCUGGGGUUGUACCCACCCCAGAGGCCCACGUGGCGGCUAGUACUCCGGUAUUGCGGUACCCUUGUACGCCUGUUUUAGUU" -structureDBN "((...))...((((((((.(((((((((.......)))))))))(((.....)))(((..((((...((((......))))...))))))))))))))).." -bp "#606060" -backbone "#000000" -basesStyle1 "outline=#A0A0A0,label=#A0A0A0,fill=#FFFFFF" -basesStyle2 "outline=#0000FF,label=#0000FF,fill=#FFFFFF" -basesStyle3 "outline=#FF0000,label=#FF0000,fill=#FFFFFF" -drawBases False -baseInner "#FFFFFF" -spaceBetweenBases "0.57" -drawBackbone False -bpStyle simple -colorMapStyle "0:#646464;0.5:#fad505;1:#f53131" -colorMap "0.7;0.8;0.2;1.0;1.0;1.0;0.0;1.0;1.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;1.0;1.0;1.0;1.0;1.0;0.5;0.5;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.5;1.0;0.5;0.0;0.0;0.0;1.0;0.0;0.0;1.0;0.0;0.5;1.0;1.0;0.5;1.0;1.0;1.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.0;0.5;1.0;1.0;1.0;0.0;0.0;0.0;0.0;0.0;0.0;0.5;0.5;0.5;0.0;0.5;0.5;1.0;0.5;0.5;0.5;0.0;0.5;0.0;0.5;0.0;0.5;0.5;" -o Plot.png -resolution "5.0"
```

<br>

<p align="right">Back to [[Memo]] &emsp; </p>
