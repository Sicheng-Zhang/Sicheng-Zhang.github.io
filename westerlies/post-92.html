<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.2.7" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>Arch Linux: install on Surface Pro (2017): WESTERLIES â€” a personal web notebook</title>
</head>
<body class="tc-body">


<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists  tc-tagged-Arch tc-tagged-Linux tc-tagged-Memo" data-tags="Arch Linux Memo" data-tiddler-title="Arch Linux: install on Surface Pro (2017)" role="article"><div class="tc-tiddler-title"><div class="tc-titlebar"><span class="tc-tiddler-controls"><button aria-expanded="false" aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><div class=" tc-reveal" hidden="true"></div><button aria-label="edit" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span><h2 class="tc-title">Arch Linux: install on Surface Pro (2017)</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class="tc-reveal"></div><div class=" tc-reveal"></div><div class=" tc-reveal"><div class="tc-tags-wrapper"><span class="tc-tag-list-item" data-tag-title="Arch"><span aria-expanded="false" class="tc-tag-label tc-btn-invisible" draggable="true" style="background-color:;
fill:#283c46;
color:#283c46;">Arch</span><span class="tc-drop-down tc-reveal" hidden="true"></span></span><span class="tc-tag-list-item" data-tag-title="Linux"><span aria-expanded="false" class="tc-tag-label tc-btn-invisible" draggable="true" style="background-color:;
fill:#283c46;
color:#283c46;">Linux</span><span class="tc-drop-down tc-reveal" hidden="true"></span></span><span class="tc-tag-list-item" data-tag-title="Memo"><span aria-expanded="false" class="tc-tag-label tc-btn-invisible" draggable="true" style="background-color:#5265c7;
fill:#ffffff;
color:#ffffff;"><svg class="tc-image-tag-button tc-image-button" height="22pt" viewBox="0 0 128 128" width="22pt"><g fill-rule="evenodd"><path d="M18.164 47.66l.004 4.105c.003 3.823 2.19 9.097 4.885 11.792l61.85 61.85c2.697 2.697 7.068 2.69 9.769-.01L125.767 94.3a6.903 6.903 0 00.01-9.77L63.928 22.683c-2.697-2.697-7.976-4.88-11.796-4.881l-27.076-.007a6.902 6.902 0 00-6.91 6.91l.008 9.96.287.033c3.73.411 8.489-.044 13.365-1.153a9.702 9.702 0 0111.14-3.662l.291-.13.128.285a9.7 9.7 0 013.3 2.17c3.796 3.796 3.801 9.945.012 13.734-3.618 3.618-9.386 3.777-13.204.482-5.365 1.122-10.674 1.596-15.309 1.237z"></path><path d="M47.633 39.532l.023.051c-9.689 4.356-21.584 6.799-30.396 5.828C5.273 44.089-1.028 36.43 2.443 24.078 5.562 12.976 14.3 4.361 24.047 1.548c10.68-3.083 19.749 1.968 19.749 13.225h-8.623c0-4.859-3.078-6.573-8.735-4.94-6.91 1.995-13.392 8.383-15.694 16.577-1.915 6.818.417 9.653 7.46 10.43 7.126.785 17.531-1.352 25.917-5.121l.027.06.036-.017c1.76-.758 6.266 6.549 3.524 7.74a2.8 2.8 0 01-.075.03z"></path></g></svg>Memo</span><span class="tc-drop-down tc-reveal" hidden="true"></span></span></div></div><div class="tc-tiddler-body tc-reveal"><div class="markdown">
<p><br><br>
</p>
<ol>
<li>
<p><strong>Download the Arch Linux ISO from</strong> <a class="tc-tiddlylink-external _codified_" href="https://archlinux.org/download/" rel="noopener noreferrer" target="_blank">https://archlinux.org/download/</a>
</p>
</li>
<li>
<p><strong>Create a live USB of Arch Linux, boot from the live USB</strong>
</p>
<ul>
<li>See <a class="tc-tiddlylink-external _codified_" href="https://wiki.archlinux.org/title/USB_flash_installation_medium" rel="noopener noreferrer" target="_blank">https://wiki.archlinux.org/title/USB_flash_installation_medium</a> for details</li>
<li>To boot Surface Pro from USB, press and hold the volume-down button. Press and release the power button until the Surface logo appears on screen.</li>
</ul>
</li>
<li>
<p><strong>Connect to Wifi</strong>
</p>
<ul>
<li>list network interface, enter <code class="_codified_">iwctl</code> interactive prompt<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">ip <span class="hljs-built_in">link</span></span>
<span class="hljs-meta">$ </span><span class="language-bash">iwctl</span>
</code></pre>
</li>
<li>list all Wi-Fi devices, find the wireless device name<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">device list</span>
</code></pre>
</li>
<li>scan for networks, list all available networks, and finally, connect to a network<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">station device scan</span>
<span class="hljs-meta">$ </span><span class="language-bash">station device get-networks</span>
<span class="hljs-meta">$ </span><span class="language-bash">station device connect SSID</span>
</code></pre>
</li>
<li>check the internet connection<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">ping archlinux.org</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Partition the disks</strong>
</p>
<ul>
<li>List all the disk and partitions, select the disk for formatting and partitioning<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">fdisk -l</span>
<span class="hljs-meta">$ </span><span class="language-bash">fdisk /dev/nvme0n1</span>
</code></pre>
</li>
<li>Create an ESP partition (For UEFI systems only):
<ul>
<li>enter <code class="_codified_">n</code>, it will ask you to choose a disk number, enter 1. Stay with the default block size, when it asks for the partition size, enter <code class="_codified_">+512M</code><br>
<a href="https://ucarecdn.com/cf04c112-8e1b-4b33-a11c-28c6aafade5d/image_1636143911959_0.png" rel="noopener noreferrer" target="_blank"><img alt="WESTERLIES" src="https://ucarecdn.com/cf04c112-8e1b-4b33-a11c-28c6aafade5d/image_1636143911959_0.png" width="600"></a></li>
<li>change the type of the EFI partition to EFI System by enter <code class="_codified_">t</code>, enter <code class="_codified_">L</code> to see all the partition types available and then enter its corresponding number to the EFI system<br>
<a href="https://ucarecdn.com/f0c9df90-2224-4c10-9bb7-911d0b95c2a8/image_1636143969249_0.png
" rel="noopener noreferrer" target="_blank"><img alt="WESTERLIES" src="https://ucarecdn.com/f0c9df90-2224-4c10-9bb7-911d0b95c2a8/image_1636143969249_0.png
" width="600"></a></li>
</ul>
</li>
<li>Create root partition (no swap, no home)
<ul>
<li>enter <code class="_codified_">n</code> to create a new partition. It will automatically give it partition number 2. Keep on pressing enter to allocate entire remaining disk space to the root partition.</li>
</ul>
</li>
<li>Finally, enter <code class="_codified_">w</code> command to write the changes and exit out of <code class="_codified_">fdisk</code> command</li>
</ul>
</li>
<li>
<p><strong>Create filesystem</strong>
</p>
<ul>
<li>with two disk partitions (<code class="_codified_">nvme0n1p1</code> and <code class="_codified_">nvme0n1p2</code>), create a FAT32 file system and create an Ext4 filesystem on the root partition<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">mkfs.fat -F32 /dev/nvme0n1p1</span>
<span class="hljs-meta">$ </span><span class="language-bash">mkfs.ext4 /dev/nvme0n1p2</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Install Arch Linux</strong>
</p>
<ul>
<li>mount Arch Linux on the root directory and install the packages<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">mount /dev/nvme0n1p2 /mnt</span>
<span class="hljs-meta">$ </span><span class="language-bash">pacstrap /mnt base linux linux-firmware vim sudo <span class="hljs-comment">#add more if needed</span></span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Configure the Arch Linux</strong>
</p>
<ul>
<li>define how disk partitions, enter the mounted disk as root<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</span>
<span class="hljs-meta">$ </span><span class="language-bash">arch-chroot /mnt</span>
</code></pre>
</li>
<li>set up timezone<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">timedatectl list-timezones</span>
<span class="hljs-meta">$ </span><span class="language-bash">timedatectl set-timezone America/Chicago</span>
</code></pre>
</li>
<li>set up <code class="_codified_">Locale</code>
<ul>
<li>edit the flie <code class="_codified_">/etc/locale.gen</code>, uncomment <code class="_codified_">en_US.UTF-8</code></li>
<li>generate the locale config<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">locale-gen</span>
<span class="hljs-meta">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> LANG=en_US.UTF-8 &gt; /etc/locale.conf</span>
<span class="hljs-meta">$ </span><span class="language-bash"><span class="hljs-built_in">export</span> LANG=en_GB.UTF-8</span>
</code></pre>
</li>
</ul>
</li>
<li>set up network
<ul>
<li>create <code class="_codified_">/etc/hostname</code> file and set the hostname (e.g. Camus)<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> Camus &gt; /etc/hostname</span>
<span class="hljs-meta">$ </span><span class="language-bash"><span class="hljs-built_in">touch</span> /etc/hosts</span>
</code></pre>
</li>
</ul>
</li>
<li>edit <code class="_codified_">/etc/hostname</code> by adding the following lines<pre class="hljs"><code class="shell hljs">127.0.0.1	localhost
::1		localhost
127.0.1.1	Camus
</code></pre>
</li>
<li>set up bluetooth
<ul>
<li>install <code class="_codified_">bluez</code> and enable the service<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">pacman -S bluez bluez-utils</span>
<span class="hljs-meta">$ </span><span class="language-bash">systemctl bluetooth.service</span>
</code></pre>
</li>
</ul>
</li>
<li>set up root password<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">passwd</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Install Grub bootloader</strong>
- make sure that you are still using arch-chroot to perform the following commands
</p>
<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">pacman -S grub efibootmgr</span>
<span class="hljs-meta">$ </span><span class="language-bash"><span class="hljs-built_in">mkdir</span> /boot/efi</span>
<span class="hljs-meta">$ </span><span class="language-bash">mount /dev/nvme0n1p1 /boot/efi</span>
<span class="hljs-meta">$ </span><span class="language-bash">grub-install --target=x86_64-efi --bootloader-id=GRUB --efi-directory=/boot/efi</span>
<span class="hljs-meta">$ </span><span class="language-bash">grub-mkconfig -o /boot/grub/grub.cfg</span>
</code></pre>
</li>
<li>
<p><strong>Install desktop environment</strong>
</p>
<ul>
<li>install X environment <code class="_codified_">Xorg</code><pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">pacman -S xorg</span>
</code></pre>
</li>
<li>install GNOME and enable the display manager<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">pacman -S archlinux-keyring</span>
<span class="hljs-meta">$ </span><span class="language-bash">pacman -S gnome</span>
<span class="hljs-meta">$ </span><span class="language-bash">systemctl start gdm.service</span>
<span class="hljs-meta">$ </span><span class="language-bash">systemctl <span class="hljs-built_in">enable</span> gdm.service</span>
<span class="hljs-meta">$ </span><span class="language-bash">pacman -S networkmanager</span>
<span class="hljs-meta">$ </span><span class="language-bash">systemctl <span class="hljs-built_in">enable</span> NetworkManager.service</span>
</code></pre>
</li>
<li>install KDE Plasma<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">pacman -S xorg plasma plasma-wayland-session</span> 
<span class="hljs-meta">$ </span><span class="language-bash">systemctl <span class="hljs-built_in">enable</span> sddm.service</span>
<span class="hljs-meta">$ </span><span class="language-bash">systemctl <span class="hljs-built_in">enable</span> NetworkManager.service</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Create a sudo user</strong>
</p>
<ul>
<li>create a home directory for the new user (e.g. Sicheng), setup password<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">useradd -m Sicheng</span>
<span class="hljs-meta">$ </span><span class="language-bash">passwd Sicheng</span>
</code></pre>
</li>
<li>give the user sudo access<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">EDITOR=vim vi sudo</span>
</code></pre>
</li>
<li>add the following line, save and exit<pre class="hljs"><code class="shell hljs">Sicheng ALL=(ALL) ALL
</code></pre>
</li>
</ul>
</li>
</ol>
<p><strong>Finally, exit from chroot, restart the system.</strong>
</p>
<p><br><br>
<strong>Tip</strong>
</p>
<ul>
<li>For KDE Plasma DE, disable <code class="_codified_">baloo file extractor</code> can free up CPU and memory<pre class="hljs"><code class="shell hljs"><span class="hljs-meta">$ </span><span class="language-bash">balooctl monitor</span>
</code></pre>
</li>
<li>Install <code class="_codified_">linux-surface</code> kernel to enable touch screen.
<ul>
<li><a class="tc-tiddlylink-external _codified_" href="https://github.com/linux-surface/linux-surface/wiki/Installation-and-Setup#Arch" rel="noopener noreferrer" target="_blank">https://github.com/linux-surface/linux-surface/wiki/Installation-and-Setup#Arch</a></li>
</ul>
</li>
</ul>
</div></div>
</div></p>
</section>
</body>
</html>

